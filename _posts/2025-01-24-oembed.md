---
layout: post
title: "oEmbed - get metadata and embed code for a media asset"
tags: oembed
---

I often google "get youtube video thumbnail".

[Oembed](https://oembed.com/) playground

```html
<link rel="alternate" type="application/json+oembed" href="https://www.youtube.com/oembed?format=json&amp;url=https%3A%2F%2Fwww.youtube.com%2Fwatch%3Fv%3Do0yf1cX76to" title="Adding Full Text Search to Rails Directory - Part 10">

https://www.youtube.com/oembed?format=json&url=https%3A%2F%2Fwww.youtube.com%2Fwatch%3Fv%3Do0yf1cX76to

https://oembed.com/

Link: <http://flickr.com/services/oembed?url=http%3A%2F%2Fflickr.com%2Fphotos%2Fbees%2F2362225867%2F&format=json>; rel="alternate"; type="application/json+oembed"; title="Bacon Lollys oEmbed Profile"
```

add an input field that would allow you to enter a url and then display the oembed html.

to get the oembed url, you need to make a request to url and find the link tag with rel="alternate" and type="application/json+oembed"

if the url is not supported, display an error message

if the url is supported, display the oembed json under the input field

make it work for

https://www.youtube.com/oembed?url=

`https://vimeo.com/api/oembed.json?url=

https://fast.wistia.com/oembed?url=

<script>
class VideoThumbnailPreview {
  constructor(container) {
    this.container = container;
    this.input = container.querySelector('.video-input');
    this.thumbnailOutput = container.querySelector('.video-thumbnail-output');
    this.dataOutput = container.querySelector('.video-data-output');
    
    // Bind event listeners
    this.input.addEventListener('input', () => this.fetchThumbnail());
    
    // Initial fetch if there's a value
    this.fetchThumbnail();
  }

  async fetchThumbnail() {
    const url = this.input.value;
    if (!url) {
      this.clearOutput();
      return;
    }

    const videoProvider = this.detectVideoProvider(url);
    if (!videoProvider) {
      this.clearOutput();
      return;
    }

    try {
      const data = await this.fetchOembedData(url, videoProvider);
      if (data) {
        this.thumbnailOutput.innerHTML = `<img src="${data.thumbnail_url}" alt="Video thumbnail">`;
        this.dataOutput.innerHTML = JSON.stringify(data, null, 2);
      } else {
        this.clearOutput();
      }
    } catch (error) {
      this.clearOutput();
    }
  }

  clearOutput() {
    this.thumbnailOutput.innerHTML = '';
    this.dataOutput.innerHTML = '';
  }

  detectVideoProvider(url) {
    if (url.match(/youtu/)) return 'youtube';
    if (url.match(/vimeo/)) return 'vimeo';
    if (url.match(/wistia/)) return 'wistia';
    return null;
  }

  async fetchOembedData(url, provider) {
    const endpoints = {
      youtube: `https://www.youtube.com/oembed?url=${encodeURIComponent(url)}&format=json`,
      vimeo: `https://vimeo.com/api/oembed.json?url=${encodeURIComponent(url)}`,
      wistia: `https://fast.wistia.com/oembed?url=${encodeURIComponent(url)}&format=json`
    };

    const endpoint = endpoints[provider];
    if (!endpoint) return null;

    const response = await fetch(endpoint);
    if (!response.ok) return null;

    const data = await response.json();
    return data;
  }
}

document.addEventListener('DOMContentLoaded', () => {
  const container = document.querySelector('#video-preview-container');
  window.videoPreview = new VideoThumbnailPreview(container);
});
</script>

<div id="video-preview-container">
  <div>
    <input 
      type="text" 
      value="https://www.youtube.com/watch?v=TcGXLorlXwQ"
      class="video-input" 
      placeholder="Enter video URL (YouTube, Vimeo, or Wistia)"
    >
    <button onclick="videoPreview.fetchThumbnail()">
      Get oEmbed
    </button>
  </div>
  <div class="video-thumbnail-output"></div>
  <div class="video-data-output"></div>
</div>
